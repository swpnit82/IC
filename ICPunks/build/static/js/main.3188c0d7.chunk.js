(this.webpackJsonpicpunks_assets=this.webpackJsonpicpunks_assets||[]).push([[0],{63:function(t){t.exports=JSON.parse('{"canisters":{"icpunks":{"main":"service/ICPunks.mo","type":"motoko"},"icpunks_assets":{"dependencies":["icpunks"],"frontend":{"entrypoint":"src/index.tsx"},"source":["build","public"],"type":"assets"}},"defaults":{"build":{"packtool":"vessel sources","output":"build"},"start":{"address":"127.0.0.1","port":8000,"serve_root":"build"}},"dfx":"0.7.2","networks":{"local":{"bind":"127.0.0.1:8000","type":"ephemeral"}},"version":1}')},85:function(t,e){},89:function(t,e,n){"use strict";n.r(e);var i=n(0),a=n(29),c=n.n(a),s=n(5),r=n(11),o=n(36),l=n(4);var u=n(61);const d=new URLSearchParams(document.location.search).get("internetIdentityUrl")||Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_INTERNET_IDENTITY_URL||"https://identity.ic0.app";const h=new class{constructor(){return this.authClient=void 0,this.ready=!1,this}async create(){var t;this.authClient=await u.a.create(),await(null===(t=this.authClient)||void 0===t?void 0:t.isAuthenticated()),this.ready=!0}async login(){return new Promise((async t=>{var e;await(null===(e=this.authClient)||void 0===e?void 0:e.login({identityProvider:d,onSuccess:async()=>{var e;t(null===(e=this.authClient)||void 0===e?void 0:e.getIdentity())}}))}))}async logout(){var t;return null===(t=this.authClient)||void 0===t?void 0:t.logout({returnTo:"/"})}async getIdentity(){var t;return null===(t=this.authClient)||void 0===t?void 0:t.getIdentity()}async isAuthenticated(){var t;return null===(t=this.authClient)||void 0===t?void 0:t.isAuthenticated()}};const j=({IDL:t})=>t.Service({claim:t.Func([t.Nat],[t.Bool],[]),countClaimedTokens:t.Func([],[t.Nat],["query"]),listTokens:t.Func([],[t.Vec(t.Opt(t.Principal))],["query"]),name:t.Func([],[t.Text],["query"]),symbol:t.Func([],[t.Text],["query"]),totalSupply:t.Func([],[t.Nat],["query"]),transferFrom:t.Func([t.Principal,t.Nat],[t.Bool],[]),userTokens:t.Func([t.Principal],[t.Vec(t.Nat)],["query"])});var b=n(63);const O="local"===(Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).DFX_NETWORK||"local");const p=O?b.networks.local.bind:void 0;const v=new class{constructor(){this._actor=void 0,this._isAuthenticated=!1,this._actor=this.initBaseActor()}async initBaseActor(t){const{agent:e,actor:n}=function(t){const e=new s.c({host:p,identity:t});return{actor:s.a.createActor(j,{agent:e,canisterId:"rrkah-fqaaa-aaaaa-aaaaq-cai"}),agent:e}}(t);return O&&await e.fetchRootKey(),n}get actor(){return this._actor}async authenticateActor(t){this._actor=this.initBaseActor(t),this._isAuthenticated=!0}unauthenticateActor(){this._actor=this.initBaseActor(),this._isAuthenticated=!1}};const y=Object(i.createContext)(null);function m({children:t}){const e=function(t){const[e,n]=Object(i.useState)(!1),[a,c]=Object(i.useState)(),[s,r]=Object(i.useState)(!1);return t.ready||t.create().then((()=>r(!0))),Object(i.useEffect)((()=>{t.ready&&Promise.all([t.getIdentity(),t.isAuthenticated()]).then((([t,e])=>{n(e||!1),c(t),r(!0)}))}),[s]),Object(i.useEffect)((()=>{a&&!a.getPrincipal().isAnonymous()?(r(!1),v.authenticateActor(a).then((()=>{r(!0)}))):v.unauthenticateActor()}),[a]),{isAuthenticated:e,isAuthReady:s,logIn:async function(){if(!t)return;await t.login();const e=await t.getIdentity();e?(n(!0),c(e)):console.error("Could not get identity from internet identity")},logOut:function(){n(!1),localStorage.removeItem(C),t.ready&&t.logout()},identity:a}}(h);return Object(l.jsx)(y.Provider,{value:e,children:t})}const x=()=>Object(i.useContext)(y),g="ICPunks",f=[{el:"meta",attrs:{name:"apple-mobile-web-app-title",content:g}},{el:"meta",attrs:{name:"apple-mobile-web-app-capable",content:"yes"}},{el:"meta",attrs:{name:"apple-mobile-web-app-status-bar-style",content:"black"}}],S=v;async function _(t){var e=await S.actor;return await e.claim(BigInt(t))}const C="ic-icpunks-user";var k=n(91),A=n(97);function T({value:t,index:e}){const[n,a]=Object(i.useState)(""),[c,s]=Object(i.useState)(Object(l.jsx)(k.a,{variant:"primary",onClick:async function(){if(!u.isAuthenticated)return;if(r)return;o(!0),s(Object(l.jsx)(l.Fragment,{children:"Claiming ..."})),await _(e)?s(Object(l.jsx)(l.Fragment,{children:"Claimed!"})):s(Object(l.jsx)(l.Fragment,{children:"Error during claiming"}));o(!1)},children:"Claim!"})),[r,o]=Object(i.useState)(!1),u=x();let d="punks/cat"+(e+1)+".png";return Object(i.useEffect)((()=>{var e;""===t.toString()?a("Still ownerless, claim it!"):a("Already Claimed, sorry"),u.isAuthenticated&&(null===(e=u.identity)||void 0===e?void 0:e.getPrincipal().toString())===t.toString()&&(a("Your token!"),s(Object(l.jsx)(l.Fragment,{})))}),[t,u.isAuthenticated]),Object(l.jsxs)(A.a,{style:{width:"18rem",margin:"20px"},children:[Object(l.jsx)(A.a.Img,{variant:"top",src:d}),Object(l.jsxs)(A.a.Body,{children:[Object(l.jsxs)(A.a.Title,{children:["Punk ",e]}),Object(l.jsx)(A.a.Text,{children:n}),c]})]})}var E=n(92),w=n(93),P=n(94);class I extends i.Component{async componentDidMount(){var t=await async function(){var t=await S.actor;return await t.listTokens()}();this.setState({tokens:t})}render(){return null===this.state||null===this.state.tokens?Object(l.jsx)(l.Fragment,{children:"Loading ..."}):Object(l.jsx)(E.a,{fluid:!0,children:Object(l.jsx)(w.a,{children:this.state.tokens.map(((t,e)=>Object(l.jsx)(P.a,{xl:"3",lg:"4",md:"6",sm:"12",children:Object(l.jsx)(T,{value:t,index:e})},e)))})})}}function F(){return Object(l.jsx)(o.a,{children:Object(l.jsx)(r.c,{children:Object(l.jsx)(r.a,{exact:!0,path:"/",children:Object(l.jsx)(I,{})})})})}var N=n(95),R=n(96);function B(){const t=x();if(t.isAuthenticated){var e;let n=null===(e=t.identity)||void 0===e?void 0:e.getPrincipal(),i=null===n||void 0===n?void 0:n.toString();return Object(l.jsxs)("div",{children:[Object(l.jsx)("span",{children:i}),Object(l.jsx)(k.a,{variant:"outline-success",onClick:function(){t.logOut()},children:"Logout"})]})}return Object(l.jsx)(k.a,{variant:"outline-success",onClick:async function(){t.logIn()},children:"Login"})}function D(){return Object(l.jsxs)(N.a,{bg:"light",expand:"lg",children:[Object(l.jsx)(N.a.Brand,{href:"#home",children:"ICPunks"}),Object(l.jsx)(N.a.Toggle,{"aria-controls":"basic-navbar-nav"}),Object(l.jsxs)(N.a.Collapse,{id:"basic-navbar-nav",children:[Object(l.jsxs)(R.a,{className:"mr-auto",children:[Object(l.jsx)(R.a.Link,{href:"/",children:"Punks"}),Object(l.jsx)(R.a.Link,{href:"/about",children:"About"})]}),Object(l.jsx)(B,{})]})]})}function L(){return Object(l.jsxs)(m,{children:[Object(l.jsx)(D,{}),Object(l.jsx)(F,{})]})}(t=>{t.title=g,f.forEach((({el:e,attrs:n})=>{const i=t.createElement(e);Object.entries(n).forEach((([t,e])=>{i[t]=e})),t.head.appendChild(i)}))})(document),c.a.render(Object(l.jsx)(L,{}),document.getElementById("app"))}},[[89,1,2]]]);
//# sourceMappingURL=main.3188c0d7.chunk.js.map